<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script async type="module">
      import { createNewInstance } from "../@Reqeza/index.mjs";

      const http = createNewInstance({
        PREFIX_URL: "https://i.picsum.photos",
      });

      function blobToBase64(blob) {
        return new Promise((resolve, _) => {
          const reader = new FileReader();
          reader.onloadend = () => resolve(reader.result);
          reader.readAsDataURL(blob);
        });
      }

      function saveAs(fileName, base64String) {
        const element = document.createElement("a");
        element.setAttribute("href", base64String);
        element.setAttribute("download", fileName);
        element.style.display = "none";
        document.body.appendChild(element);
        element.click();
        document.body.removeChild(element);
      }

      async function getProducts() {
        const res = await http
          .get(
            "/id/866/200/300.jpg?hmac=rcadCENKh4rD6MAp6V_ma-AyWv641M4iiOpe1RyFHeI"
          )
          .blob();

        const img = await blobToBase64(res.data);

        saveAs("image.jpg", img);
        // const imageObjectURL = URL.createObjectURL(res.data);

        console.log(img);
      }

      await getProducts();
    </script>
  </body>
</html>
